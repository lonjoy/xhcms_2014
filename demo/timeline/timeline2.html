<!DOCTYPE HTML>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>timeline-index2</title>
    <link rel="stylesheet" href="../../css/jqueryui/jquery-ui.css"/>
    <link rel="stylesheet" type="text/css" href="css/my-timeline.css"/>
    <script type="text/javascript" src="../../js/jquery.min.js"></script>
    <script src="../../js/require.js"></script>
    <script src="../../js/require-config.js"></script>
    <style> 
    #timeline-embed h2.tips{height:30px;text-align:center;padding:30px;font-family:微软雅黑;font-size:16px; color:#CCC;}
    </style>
  </head>
  <body>
    <!--wrapper 开始-->
  	<div class="wrapper">
  		<!-- <div class="top">
  			<p class="top_left">编辑时间轴</p>
  			<p class="top_right"></p>
  		</div> -->
      <!--tabnum 点击换背景部分 开始-->
  		<div class="tabnum">
  			<dl>
  				<dt>
  					<h4>搜索新闻</h4>
					  <P>可指定时间段，输入关键 词搜索新闻</P>  					
  				</dt>
  				<dd>1</dd>
  			</dl>
        <div class="arrow"></div>

        <dl class="addbg">
          <dt>
            <h4>设置时间轴</h4>
            <P>调整、设置时间轴样式， 预览时间轴</P>           
          </dt>
          <dd class="addbg2">2</dd>
        </dl>   
  		</div><!--tabnum 点击换背景部分 结束-->

      <!--center 开始-->
      <div class="select-all">
        <div class="time_name" id="time_name">
          <label>时间轴名称：</label>
            <input type="text" placeholder="" name="tname" />
        </div>

        <!--排序方式 开始-->
        <div class="rank">
          <div class="rank_l">
            <label>稿件排序方式：</label>
            <ul id="grank_rank">
                <li><a href="javascript:void(0)" data-value="occur">按发生时间</a></li>
                <li><a href="javascript:void(0)" data-value="release">按发布时间</a></li>
            </ul>
         </div>
          <div class="rank_r">
            <label>默认时间位置：</label>
            <ul id="trank_rank">
                <li><a href="javascript:void(0)" data-value="newest">定位到最新</a></li>
                <li><a href="javascript:void(0)" data-value="oldest">定位到最旧</a></li>
            </ul>
          </div>
        </div><!--排序方式 结束-->

        <!--时间 开始-->
        <div class="timescale">
          <div class="timescale_l">
            <label>时间刻度：</label>
            <ul id="timel_rank">
                <li data-value="y"><a href="javascript:void(0)">年</a></li>
                <li data-value="M"><a href="javascript:void(0)">月</a></li>
                <li data-value="d"><a href="javascript:void(0)">日</a></li>
                <li data-value="h"><a href="javascript:void(0)">时</a></li>
                <li data-value="m"><a href="javascript:void(0)">分</a></li>
            </ul>
         </div>
          <div class="timescale_r">
            <label>时间轴样式：</label>
            <ul id="timer_rank">
                <li><a href="javascript:void(0)" data-value="imgtxt">图文横轴式</a></li>
                <li><a href="javascript:void(0)" data-value="title">标题横轴式</a></li>
            </ul>
          </div>
        </div><!--时间 结束-->
      </div><!--center 结束-->


      <!--时间轴切换 开始-->
      <!-- <div class="timeTab"> -->
        <div id="my-timeline" class="my-timeline">
        </div>
      <!-- </div> --><!--时间轴切换 结束-->

      
      <div class="prev-next">
        <a href="timeline.html" id="back">上一步</a>
        <a href="javascript:void(0)" class="complete">完成</a>
        <a href="timeline3.html" class="cancel">取消</a>
      </div>
      
  	</div> <!--wrapper 结束-->
    <script>

  //时间轴tab切换
  /*
  require(['timeline'],function(){
    $.ajax({
      url: '../json/timeline.json',
      dataType: 'json',
      success: function(data){

        createStoryJS({
              type:       'timeline',
              width:      '100%',
              height:     '600',
              start_at_slide: 0,
              start_zoom_adjust: 3,
              lang:"zh-cn",
              // source:     data,
              embed_id:   'my-timeline',
              start_at_end : true,
              maptype:'watercolor'
          },data);
      }
    });

  });
*/
/*
  require(['time-line','underscore'],function(Timeline){
    var data = {
      timelineContent:[]
    };
    var dd = $('#timel_rank').children('.cur').data('value'), d = 10; //时间密度
    switch(dd){
      case 'y': d = 4; break;
      case 'M': d = 7; break;
      case 'h': d = 13; break;
      case 'm': d = 16; break;
    }
    var list = [];

    _.each(parent.timeLineFN.list,function(item){
      list.push( {
        cid: item.docId,
        title: item.docName,
        date: item.releaseDate,
        url : item.docUrl
      } );
    });   //复制 & 修改属性名

    list = _.groupBy(list,function(item){
      return item.date.substring(0,d);
    });   
    for(var k in list){
      data.timelineContent.push({
        time:k,
        data:list[k]
      });
    }     //分组

    var timel = Timeline({
      embed : '#my-timeline'
    },data);   //生成时间轴

    //获取删除结果
    $('#back').on('click',function(){
      var listIds = timel.getAllIds(),  //.join(','),   // 删除之后的id数组个数（加join的话就成字符串了？）
          oldList = parent.timeLineFN.list, 
          newList = [];

      _.each(oldList,function(item){
        if( _.indexOf(listIds,item.docId) !== -1 ){
          newList.push(item);
        }
      });

      parent.timeLineFN.list = newList;

    });



    //点击“完成”按钮
    $(".complete").on('click',function(){
      $.ajax({
        url: "json/news.json",
        data:{
          //ids: _.pluck(window.parent.timeLineFN.data, 'id').join(","),
          time_name : $("#time_name input").val(),                       //时间轴名称
          grank_rank: $('#grank_rank li.cur a').data("value"),           //稿件排序方式
          trank_rank: $('#trank_rank li.cur a').data("value"),           //默认时间位置
          timel_rank: $('#timel_rank li.cur a').data("value"),           //时间刻度
          timer_rank: $('#timer_rank li.cur a').data("value"),            //时间轴样式
          ids : timel.getAllIds()
        },
        success: function(data){
          for( var i=0;i<data.length;i++ ){
            window.parent.timeLineFN.complete( data[i].id );
          }
        }
      }); 
    });

  });
*/
  

    </script>
    <script type="text/javascript" src="js/my-timeline2.js"></script>
  </body>
</html>  